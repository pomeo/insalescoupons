{"version":3,"sources":["addons/nestable.js"],"names":["addon","component","jQuery","UIkit","define","amd","$","UI","hasTouch","window","html","touchedlists","$win","hasPointerEvents","el","document","createElement","docEl","documentElement","style","pointerEvents","appendChild","supports","getComputedStyle","removeChild","eStart","eMove","eEnd","eCancel","defaults","prefix","listNodeName","itemNodeName","listBaseClass","listClass","listitemClass","itemClass","dragClass","movingClass","handleClass","collapsedClass","placeClass","noDragClass","emptyClass","group","maxDepth","threshold","init","$this","this","Object","keys","options","forEach","key","String","indexOf","replace","tplempty","find","addClass","end","element","children","length","append","data","Date","getTime","Math","ceil","random","reset","placeEl","each","setParent","on","e","dragEl","button","preventDefault","target","currentTarget","action","item","closest","collapseItem","expandItem","toggleItem","onStartEvent","handle","hasClass","touches","dragStart","trigger","onMoveEvent","dragMove","onEndEvent","dragStop","addEventListener","serialize","depth","list","step","level","array","items","li","extend","sub","push","parent","index","parent_id","order","idProperty","mouse","offsetX","offsetY","startX","startY","lastX","lastY","nowX","nowY","distX","distY","dirAx","dirX","dirY","lastDirX","lastDirY","distAxX","distAxY","moving","dragRootEl","dragDepth","hasNewRoot","pointEl","i","removeClass","lists","expandAll","collapseAll","unsetParent","remove","dragItem","offset","css","height","pageX","left","pageY","top","width","tmpDragOnSiblings","previousSibling","nextSibling","after","parentNode","appendTo","body","parents","first","replaceWith","prev","next","opt","newAx","abs","last","isEmpty","visibility","elementFromPoint","scrollLeft","pageYOffset","scrollTop","nestableitem","pointElRoot","tmpRoot","isNewRoot","$newRoot","before","ready","context","ele","nestable","Utils","attr"],"mappings":"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","file":"addons/nestable.js","sourcesContent":["/*! UIkit 2.9.0 | http://www.getuikit.com | (c) 2014 YOOtheme | MIT License */\n\n/*\n * Based on Nestable jQuery Plugin - Copyright (c) 2012 David Bushell - http://dbushell.com/\n */\n (function(addon) {\n\n     var component;\n\n     if (jQuery && jQuery.UIkit) {\n         component = addon(jQuery, jQuery.UIkit);\n     }\n\n     if (typeof define == \"function\" && define.amd) {\n         define(\"uikit-nestable\", [\"uikit\"], function(){\n             return component || addon(jQuery, jQuery.UIkit);\n         });\n     }\n\n })(function($, UI) {\n\n    var hasTouch     = 'ontouchstart' in window,\n        html         = $(\"html\"),\n        touchedlists = [],\n        $win         = UI.$win;\n\n    /**\n     * Detect CSS pointer-events property\n     * events are normally disabled on the dragging element to avoid conflicts\n     * https://github.com/ausi/Feature-detection-technique-for-pointer-events/blob/master/modernizr-pointerevents.js\n     */\n    var hasPointerEvents = (function() {\n\n        var el    = document.createElement('div'), docEl = document.documentElement;\n\n        if (!('pointerEvents' in el.style)) {\n            return false;\n        }\n\n        el.style.pointerEvents = 'auto';\n        el.style.pointerEvents = 'x';\n\n        docEl.appendChild(el);\n\n        var supports = window.getComputedStyle && window.getComputedStyle(el, '').pointerEvents === 'auto';\n\n        docEl.removeChild(el);\n\n        return !!supports;\n    })();\n\n    var eStart  = hasTouch ? 'touchstart'  : 'mousedown',\n        eMove   = hasTouch ? 'touchmove'   : 'mousemove',\n        eEnd    = hasTouch ? 'touchend'    : 'mouseup',\n        eCancel = hasTouch ? 'touchcancel' : 'mouseup';\n\n\n    UI.component('nestable', {\n\n        defaults: {\n            prefix          : 'uk',\n            listNodeName    : 'ul',\n            itemNodeName    : 'li',\n            listBaseClass   : '{prefix}-nestable',\n            listClass       : '{prefix}-nestable-list',\n            listitemClass   : '{prefix}-nestable-list-item',\n            itemClass       : '{prefix}-nestable-item',\n            dragClass       : '{prefix}-nestable-list-dragged',\n            movingClass     : '{prefix}-nestable-moving',\n            handleClass     : '{prefix}-nestable-handle',\n            collapsedClass  : '{prefix}-collapsed',\n            placeClass      : '{prefix}-nestable-placeholder',\n            noDragClass     : '{prefix}-nestable-nodrag',\n            emptyClass      : '{prefix}-nestable-empty',\n            group           : 0,\n            maxDepth        : 10,\n            threshold       : 20\n        },\n\n        init: function()\n        {\n            var $this = this;\n\n            Object.keys(this.options).forEach(function(key){\n\n                if(String($this.options[key]).indexOf('{prefix}')!=-1) {\n                    $this.options[key] = $this.options[key].replace('{prefix}', $this.options.prefix);\n                }\n            });\n\n            this.tplempty = '<div class=\"' + this.options.emptyClass + '\"/>';\n\n            this.find(\">\"+this.options.itemNodeName).addClass(this.options.listitemClass)\n                .end()\n                .find(\"ul:not(.ignore-list)\").addClass(this.options.listClass)\n                .find(\">li\").addClass(this.options.listitemClass);\n\n            if (!this.element.children(this.options.itemNodeName).length) {\n                this.element.append(this.tplempty);\n            }\n\n            this.element.data(\"nestable-id\", \"ID\"+(new Date().getTime())+\"RAND\"+(Math.ceil(Math.random() *100000)));\n            this.reset();\n            this.element.data('nestable-group', this.options.group);\n            this.placeEl = $('<div class=\"' + this.options.placeClass + '\"/>');\n\n            this.find(this.options.itemNodeName).each(function() {\n                $this.setParent($(this));\n            });\n\n            this.on('click', '[data-nestable-action]', function(e) {\n\n                if ($this.dragEl || (!hasTouch && e.button !== 0)) {\n                    return;\n                }\n\n                e.preventDefault();\n\n                var target = $(e.currentTarget),\n                    action = target.data('nestableAction'),\n                    item   = target.closest($this.options.itemNodeName);\n                if (action === 'collapse') {\n                    $this.collapseItem(item);\n                }\n                if (action === 'expand') {\n                    $this.expandItem(item);\n                }\n                if (action === 'toggle') {\n                    $this.toggleItem(item);\n                }\n            });\n\n            var onStartEvent = function(e) {\n\n                var handle = $(e.target);\n\n                if (!handle.hasClass($this.options.handleClass)) {\n                    if (handle.closest('.' + $this.options.noDragClass).length) {\n                        return;\n                    }\n                    handle = handle.closest('.' + $this.options.handleClass);\n                }\n                if (!handle.length || $this.dragEl || (!hasTouch && e.button !== 0) || (hasTouch && e.touches.length !== 1)) {\n                    return;\n                }\n                e.preventDefault();\n                $this.dragStart(hasTouch ? e.touches[0] : e);\n                $this.trigger('nestable-start', [$this]);\n            };\n\n            var onMoveEvent = function(e) {\n                if ($this.dragEl) {\n                    e.preventDefault();\n                    $this.dragMove(hasTouch ? e.touches[0] : e);\n                    $this.trigger('nestable-move', [$this]);\n                }\n            };\n\n            var onEndEvent = function(e) {\n                if ($this.dragEl) {\n                    e.preventDefault();\n                    $this.dragStop(hasTouch ? e.touches[0] : e);\n                    $this.trigger('nestable-stop', [$this]);\n                }\n            };\n\n            if (hasTouch) {\n                this.element[0].addEventListener(eStart, onStartEvent, false);\n                window.addEventListener(eMove, onMoveEvent, false);\n                window.addEventListener(eEnd, onEndEvent, false);\n                window.addEventListener(eCancel, onEndEvent, false);\n            } else {\n                this.on(eStart, onStartEvent);\n                $win.on(eMove, onMoveEvent);\n                $win.on(eEnd, onEndEvent);\n            }\n\n        },\n\n        serialize: function() {\n\n            var data,\n                depth = 0,\n                list  = this;\n                step  = function(level, depth) {\n\n                    var array = [ ], items = level.children(list.options.itemNodeName);\n\n                    items.each(function() {\n\n                        var li   = $(this),\n                            item = $.extend({}, li.data()),\n                            sub  = li.children(list.options.listNodeName);\n\n                        if (sub.length) {\n                            item.children = step(sub, depth + 1);\n                        }\n                        array.push(item);\n                    });\n                    return array;\n                };\n\n            data = step(list.element, depth);\n\n            return data;\n        },\n\n        list: function(options) {\n\n            var data = [],\n                list = this,\n                depth = 0,\n                options = $.extend({}, list.options, options),\n                step = function(level, depth, parent) {\n\n                    var items = level.children(options.itemNodeName);\n\n                    items.each(function(index) {\n                        var li = $(this),\n                            item = $.extend({parent_id: (parent ? parent : null), depth: depth, order: index}, li.data()),\n                            sub = li.children(options.listNodeName);\n\n                        data.push(item);\n\n                        if (sub.length) {\n                            step(sub, depth + 1, li.data(options.idProperty || 'id'));\n                        }\n                    });\n                };\n\n            step(list.element, depth);\n\n            return data;\n        },\n\n        reset: function() {\n\n            this.mouse = {\n                offsetX   : 0,\n                offsetY   : 0,\n                startX    : 0,\n                startY    : 0,\n                lastX     : 0,\n                lastY     : 0,\n                nowX      : 0,\n                nowY      : 0,\n                distX     : 0,\n                distY     : 0,\n                dirAx     : 0,\n                dirX      : 0,\n                dirY      : 0,\n                lastDirX  : 0,\n                lastDirY  : 0,\n                distAxX   : 0,\n                distAxY   : 0\n            };\n            this.moving     = false;\n            this.dragEl     = null;\n            this.dragRootEl = null;\n            this.dragDepth  = 0;\n            this.hasNewRoot = false;\n            this.pointEl    = null;\n\n            for (var i=0; i<touchedlists.length; i++) {\n                if (!touchedlists[i].children().length) {\n                    touchedlists[i].append(this.tplempty);\n                }\n            }\n\n            touchedlists = [];\n        },\n\n        toggleItem: function(li) {\n            this[li.hasClass(this.options.collapsedClass) ? \"expandItem\":\"collapseItem\"](li);\n        },\n\n        expandItem: function(li) {\n            li.removeClass(this.options.collapsedClass);\n        },\n\n        collapseItem: function(li) {\n            var lists = li.children(this.options.listNodeName);\n            if (lists.length) {\n                li.addClass(this.options.collapsedClass);\n            }\n        },\n\n        expandAll: function() {\n            var list = this;\n            this.find(list.options.itemNodeName).each(function() {\n                list.expandItem($(this));\n            });\n        },\n\n        collapseAll: function() {\n            var list = this;\n            this.find(list.options.itemNodeName).each(function() {\n                list.collapseItem($(this));\n            });\n        },\n\n        setParent: function(li) {\n            if (li.children(this.options.listNodeName).length) {\n                li.addClass(\"uk-parent\");\n            }\n        },\n\n        unsetParent: function(li) {\n            li.removeClass('uk-parent '+this.options.collapsedClass);\n            li.children(this.options.listNodeName).remove();\n        },\n\n        dragStart: function(e) {\n            var mouse    = this.mouse,\n                target   = $(e.target),\n                dragItem = target.closest(this.options.itemNodeName),\n                offset   = dragItem.offset();\n\n            this.placeEl.css('height', dragItem.height());\n\n            mouse.offsetX = e.pageX - offset.left;\n            mouse.offsetY = e.pageY - offset.top;\n\n            mouse.startX = mouse.lastX = offset.left;\n            mouse.startY = mouse.lastY = offset.top;\n\n            this.dragRootEl = this.element;\n\n            this.dragEl = $(document.createElement(this.options.listNodeName)).addClass(this.options.listClass + ' ' + this.options.dragClass);\n            this.dragEl.css('width', dragItem.width());\n\n            this.tmpDragOnSiblings = [dragItem[0].previousSibling, dragItem[0].nextSibling];\n\n            // fix for zepto.js\n            //dragItem.after(this.placeEl).detach().appendTo(this.dragEl);\n            dragItem.after(this.placeEl);\n            dragItem[0].parentNode.removeChild(dragItem[0]);\n            dragItem.appendTo(this.dragEl);\n\n            $(document.body).append(this.dragEl);\n\n            this.dragEl.css({\n                left : offset.left,\n                top  : offset.top\n            });\n\n            // total depth of dragging item\n            var i, depth,\n                items = this.dragEl.find(this.options.itemNodeName);\n            for (i = 0; i < items.length; i++) {\n                depth = $(items[i]).parents(this.options.listNodeName).length;\n                if (depth > this.dragDepth) {\n                    this.dragDepth = depth;\n                }\n            }\n\n            html.addClass(this.options.movingClass);\n        },\n\n        dragStop: function(e) {\n            // fix for zepto.js\n            //this.placeEl.replaceWith(this.dragEl.children(this.options.itemNodeName + ':first').detach());\n            var el = this.dragEl.children(this.options.itemNodeName).first();\n            el[0].parentNode.removeChild(el[0]);\n            this.placeEl.replaceWith(el);\n\n            this.dragEl.remove();\n\n            if (this.tmpDragOnSiblings[0]!=el[0].previousSibling || this.tmpDragOnSiblings[0]!=el[0].previousSibling) {\n\n                this.element.trigger('nestable-change',[el, this.hasNewRoot ? \"added\":\"moved\"]);\n\n                if (this.hasNewRoot) {\n                    this.dragRootEl.trigger('nestable-change', [el, \"removed\"]);\n                }\n            }\n\n            this.reset();\n\n            html.removeClass(this.options.movingClass);\n        },\n\n        dragMove: function(e) {\n            var list, parent, prev, next, depth,\n                opt   = this.options,\n                mouse = this.mouse;\n\n            this.dragEl.css({\n                left : e.pageX - mouse.offsetX,\n                top  : e.pageY - mouse.offsetY\n            });\n\n            // mouse position last events\n            mouse.lastX = mouse.nowX;\n            mouse.lastY = mouse.nowY;\n            // mouse position this events\n            mouse.nowX  = e.pageX;\n            mouse.nowY  = e.pageY;\n            // distance mouse moved between events\n            mouse.distX = mouse.nowX - mouse.lastX;\n            mouse.distY = mouse.nowY - mouse.lastY;\n            // direction mouse was moving\n            mouse.lastDirX = mouse.dirX;\n            mouse.lastDirY = mouse.dirY;\n            // direction mouse is now moving (on both axis)\n            mouse.dirX = mouse.distX === 0 ? 0 : mouse.distX > 0 ? 1 : -1;\n            mouse.dirY = mouse.distY === 0 ? 0 : mouse.distY > 0 ? 1 : -1;\n            // axis mouse is now moving on\n            var newAx   = Math.abs(mouse.distX) > Math.abs(mouse.distY) ? 1 : 0;\n\n            // do nothing on first move\n            if (!mouse.moving) {\n                mouse.dirAx  = newAx;\n                mouse.moving = true;\n                return;\n            }\n\n            // calc distance moved on this axis (and direction)\n            if (mouse.dirAx !== newAx) {\n                mouse.distAxX = 0;\n                mouse.distAxY = 0;\n            } else {\n                mouse.distAxX += Math.abs(mouse.distX);\n                if (mouse.dirX !== 0 && mouse.dirX !== mouse.lastDirX) {\n                    mouse.distAxX = 0;\n                }\n                mouse.distAxY += Math.abs(mouse.distY);\n                if (mouse.dirY !== 0 && mouse.dirY !== mouse.lastDirY) {\n                    mouse.distAxY = 0;\n                }\n            }\n            mouse.dirAx = newAx;\n\n            /**\n             * move horizontal\n             */\n            if (mouse.dirAx && mouse.distAxX >= opt.threshold) {\n                // reset move distance on x-axis for new phase\n                mouse.distAxX = 0;\n                prev = this.placeEl.prev(opt.itemNodeName);\n                // increase horizontal level if previous sibling exists and is not collapsed\n                if (mouse.distX > 0 && prev.length && !prev.hasClass(opt.collapsedClass)) {\n                    // cannot increase level when item above is collapsed\n                    list = prev.find(opt.listNodeName).last();\n                    // check if depth limit has reached\n                    depth = this.placeEl.parents(opt.listNodeName).length;\n                    if (depth + this.dragDepth <= opt.maxDepth) {\n                        // create new sub-level if one doesn't exist\n                        if (!list.length) {\n                            list = $('<' + opt.listNodeName + '/>').addClass(opt.listClass);\n                            list.append(this.placeEl);\n                            prev.append(list);\n                            this.setParent(prev);\n                        } else {\n                            // else append to next level up\n                            list = prev.children(opt.listNodeName).last();\n                            list.append(this.placeEl);\n                        }\n                    }\n                }\n                // decrease horizontal level\n                if (mouse.distX < 0) {\n                    // we can't decrease a level if an item preceeds the current one\n                    next = this.placeEl.next(opt.itemNodeName);\n                    if (!next.length) {\n                        parent = this.placeEl.parent();\n                        this.placeEl.closest(opt.itemNodeName).after(this.placeEl);\n                        if (!parent.children().length) {\n                            this.unsetParent(parent.parent());\n                        }\n                    }\n                }\n            }\n\n            var isEmpty = false;\n\n            // find list item under cursor\n            if (!hasPointerEvents) {\n                this.dragEl[0].style.visibility = 'hidden';\n            }\n            this.pointEl = $(document.elementFromPoint(e.pageX - document.body.scrollLeft, e.pageY - (window.pageYOffset || document.documentElement.scrollTop)));\n            if (!hasPointerEvents) {\n                this.dragEl[0].style.visibility = 'visible';\n            }\n\n            if (this.pointEl.hasClass(opt.handleClass)) {\n                this.pointEl = this.pointEl.closest(opt.itemNodeName);\n            } else {\n\n                var nestableitem = this.pointEl.closest('.'+opt.itemClass);\n\n                if(nestableitem.length) {\n                    this.pointEl = nestableitem.closest(opt.itemNodeName);\n                }\n            }\n\n            if (this.pointEl.hasClass(opt.emptyClass)) {\n                isEmpty = true;\n            } else if (this.pointEl.data('nestable') && !this.pointEl.children().length) {\n                isEmpty = true;\n                this.pointEl = $(this.tplempty).appendTo(this.pointEl);\n            } else if (!this.pointEl.length || !this.pointEl.hasClass(opt.listitemClass)) {\n                return;\n            }\n\n            // find parent list of item under cursor\n            var pointElRoot = this.element,\n                tmpRoot     = this.pointEl.closest('.'+this.options.listBaseClass),\n                isNewRoot   = pointElRoot[0] !== this.pointEl.closest('.'+this.options.listBaseClass)[0],\n                $newRoot    = tmpRoot;\n\n            /**\n             * move vertical\n             */\n            if (!mouse.dirAx || isNewRoot || isEmpty) {\n                // check if groups match if dragging over new root\n                if (isNewRoot && opt.group !== $newRoot.data('nestable-group')) {\n                    return;\n                } else {\n                    touchedlists.push(pointElRoot);\n                }\n\n                // check depth limit\n                depth = this.dragDepth - 1 + this.pointEl.parents(opt.listNodeName).length;\n\n                if (depth > opt.maxDepth) {\n                    return;\n                }\n\n                var before = e.pageY < (this.pointEl.offset().top + this.pointEl.height() / 2);\n\n                parent = this.placeEl.parent();\n\n                // if empty create new list to replace empty placeholder\n                if (isEmpty) {\n                    this.pointEl.replaceWith(this.placeEl);\n                } else if (before) {\n                    this.pointEl.before(this.placeEl);\n                } else {\n                    this.pointEl.after(this.placeEl);\n                }\n\n                if (!parent.children().length) {\n                    if(!parent.data(\"nestable\")) this.unsetParent(parent.parent());\n                }\n\n                if (!this.dragRootEl.find(opt.itemNodeName).length && !this.dragRootEl.children().length) {\n                    this.dragRootEl.append(this.tplempty);\n                }\n\n                // parent root list has changed\n                if (isNewRoot) {\n                    this.dragRootEl = tmpRoot;\n                    this.hasNewRoot = this.element[0] !== this.dragRootEl[0];\n                }\n            }\n        }\n\n    });\n\n    // init code\n    UI.ready(function(context) {\n\n        $(\"[data-uk-nestable]\", context).each(function(){\n\n            var ele = $(this);\n\n            if(!ele.data(\"nestable\")) {\n                 var plugin = UI.nestable(ele, UI.Utils.options(ele.attr(\"data-uk-nestable\")));\n            }\n        });\n    });\n\n    return UI.nestable;\n});"],"sourceRoot":"/source/"}