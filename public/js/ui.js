$(document).ready(function(){function e(){var e=$("input[name='c-num']").val(),n=$("input[name='c-part']").val(),t=$("input[name='c-partlen']").val();$.getJSON("/sample",{number:e,parts:n,length:t},function(e){$("#coupon-sample").html(e)})}e(),$.validator.addMethod("loginRegex",function(e,n){return this.optional(n)||/^[a-zA-Zа-яА-Я0-9\-]+$/i.test(e)},"Только цифры, буквы и дефис"),$("#coupons-generate").validate({errorClass:"uk-form-danger",validClass:"uk-form-success",highlight:function(e,n,t){$(e).addClass(n).removeClass(t)},unhighlight:function(e,n,t){$(e).removeClass(n).addClass(t)},rules:{"c-num":{required:!0,range:[1,1e4]},"c-part":{required:!0,range:[1,5]},"c-partlen":{required:!0,range:[4,10]},discount:{required:!0},until:{required:!0,dateNL:!0},group:{loginRegex:!0}},submitHandler:function(e){return $(e).ajaxSubmit({success:function(e){"success"==e?$.UIkit.notify("<i class='uk-icon-check'></i> Отправлено в очередь на выполнение.<br />Состояние можно посмотреть на странице <a href='/zadaniya'>&laquo;Задания&raquo;</a>.",{status:"success"}):$.UIkit.notify("ошибка",{status:"danger"})}}),!1}}),$("input[name='c-part'], input[name='c-partlen']").change(e),$("select[name='typediscount']").change(function(){1==$("select[name='typediscount']").val()?($(".uk-icon-percent").remove(),$(".uk-icon-rub").remove(),$("#b-discount").prepend("<i class='uk-icon-percent'></i>")):($(".uk-icon-percent").remove(),$(".uk-icon-rub").remove(),$("#b-discount").prepend("<i class='uk-icon-rub'></i>"))});var n,t=[{id:"title",name:"Title",field:"title",sortable:!0},{id:"duration",name:"Duration",field:"duration",sortable:!0},{id:"%",name:"% Complete",field:"percentComplete",sortable:!0},{id:"start",name:"Start",field:"start",sortable:!0},{id:"finish",name:"Finish",field:"finish",sortable:!0},{id:"effort-driven",name:"Effort Driven",field:"effortDriven",sortable:!0}],r={enableCellNavigation:!0,enableColumnReorder:!1,multiColumnSort:!0};$.ajax({url:"/data",dataType:"json",error:function(e){alert("hi this is error message"),console.log(e)},success:function(e){for(var i=0;i<e.length;i++)e[i]={title:e[i].title,duration:e[i].duration,percentComplete:e[i].percentComplete,start:e[i].start,finish:e[i].finish,effortDriven:e[i].effortDriven};n=new Slick.Grid("#coupons",e,t,r),n.onSort.subscribe(function(t,r){var i=r.sortCols;e.sort(function(e,n){for(var t=0,r=i.length;r>t;t++){var a=i[t].sortCol.field,o=i[t].sortAsc?1:-1,s=e[a],u=n[a],l=(s==u?0:s>u?1:-1)*o;if(0!=l)return l}return 0}),n.invalidate(),n.render()})}})});